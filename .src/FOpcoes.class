' Gambas class file

' Copyright (C) 2025 Murilo Gomes Julio
' SPDX-License-Identifier: GPL-2.0-only

' Site: https://www.mugomes.com.br

Public Sub Form_Open()
  
  chkPUA.Value = MConfig.get("pua", True)
  chkHeuristica.Value = MConfig.get("heuristica", True)
  chkArquivoOcultos.Value = MConfig.get("arquivosocultos", True)
  chkArquivoSimbolico.Value = MConfig.get("arquivosimbolico", True)
  chkPastaSimbolica.Value = MConfig.get("pastasimbolica", True)
  chkArquivoCompactado.Value = MConfig.get("arquivocompactado", True)
  chkMail.Value = MConfig.get("mail", True)
  sbTamanho.Value = MConfig.get("tamanho", 0)
  
  For Each row As String In MConfig.get("ignorarpastas", [])
    lstPastas.Add(row, row)
  Next
  
  For Each row As String In MConfig.get("ignorararquivos", [])
    lstArquivos.Add(row, row)
  Next
  
End

Private Sub pua()
  
  MConfig.set("pua", chkPUA.Value)
  
End

Private Sub heuristica()
  
  MConfig.set("heuristica", chkHeuristica.Value)
  
End

Private Sub arquivosocultos()
  
  MConfig.set("arquivosocultos", chkArquivoOcultos.Value)
  
End

Private Sub arquivosimbolico()
  
  MConfig.set("arquivosimbolico", chkArquivoSimbolico.Value)
  
End

Private Sub pastasimbolica()
  
  MConfig.set("pastasimbolica", chkPastaSimbolica.Value)
  
End

Private Sub arquivocompactado()
  
  MConfig.set("arquivocompactado", chkArquivoCompactado.Value)
  
End

Private Sub mail()
  
  MConfig.set("mail", chkMail.Value)
  
End

Private Sub tamanho()
  
  MConfig.set("tamanho", sbTamanho.Value)
  
End

Public Sub btnAddPasta_Click()
  
  Dialog.Title = ("Select Folder")
  If Not Dialog.SelectDirectory() Then 
    lstPastas.Add(Dialog.Path, Dialog.Path)
  Endif
  
End

Public Sub btnRemoverPasta_Click()
  
  For Each row As String In lstPastas.Selection
    lstPastas.Remove(row)
  Next
  
End 

Public Sub btnAddArquivo_Click()
  
  Dialog.Title = ("Select Files")
  If Not Dialog.OpenFile(True) Then 
    For Each row As String In Dialog.Paths
      lstArquivos.Add(row, row)
    Next
  Endif 
  
End

Public Sub btnRemoverArquivo_Click()
  
  For Each row As String In lstArquivos.Selection
    lstArquivos.Remove(row)
  Next
  
End

Private Sub ignorarpastas()
  
  MConfig.set("ignorarpastas", lstPastas.Keys)
  
End

Private Sub ignorararquivos()
  
  MConfig.set("ignorararquivos", lstArquivos.Keys)
  
End

Public Sub btnSalvar_Click()
  
  pua()
  heuristica()
  arquivosocultos()
  arquivosimbolico()
  pastasimbolica()
  arquivocompactado()
  mail()
  tamanho()
  ignorararquivos()
  ignorarpastas()
  
  Me.Close()

End
